function LuxMain(){"use strict";var t="luxId",e="";this.lightboxInstance=null;var n=this;this.initialize=function(){i(),T()&&(a(),L(),r(),o(),l(),c()),u(),g()},this.closeLightbox=function(){null!==n.lightboxInstance&&n.lightboxInstance.close()};var i=function(){for(var t=document.querySelectorAll('[data-lux-trackingoptout="checkbox"]'),e=0;e<t.length;e++){var n=t[e];n.checked=j()===!1,n.addEventListener("change",function(){j()?J():F()})}},a=function(){e=H()},r=function(){_()&&I({"tx_lux_fe[dispatchAction]":"pageRequest","tx_lux_fe[idCookie]":H(),"tx_lux_fe[arguments][pageUid]":w(),"tx_lux_fe[arguments][referrer]":y(),"tx_lux_fe[arguments][currentUrl]":encodeURIComponent(window.location.href)},S(),"generalWorkflowActionCallback",null)};this.generalWorkflowActionCallback=function(t){for(var e=0;e<t.length;e++)if(t[e].action)try{n[t[e].action+"WorkflowAction"](t[e])}catch(i){console.log(i)}},this.lightboxContentWorkflowAction=function(t){var e=t.configuration.contentElement,i=document.querySelector("[data-lux-contenturi]").getAttribute("data-lux-contenturi")||"/index.php?id=1&type=1520192598",a='<div><iframe src="'+i+"&luxContent="+parseInt(e)+'" width="800" height="600"></iframe></div>';n.lightboxInstance=basicLightbox.create(a),setTimeout(function(){n.lightboxInstance.show()},parseInt(t.configuration.delay))},this.redirectWorkflowAction=function(t){t.configuration.uri&&(window.location=t.configuration.uri)};var o=function(){var t="form:not([data-lux-form-identification]) input:not([data-lux-disable]), ";t+="form:not([data-lux-form-identification]) textarea:not([data-lux-disable]), ",t+="form:not([data-lux-form-identification]) select:not([data-lux-disable]), ",t+="form:not([data-lux-form-identification]) radio:not([data-lux-disable]), ",t+="form:not([data-lux-form-identification]) check:not([data-lux-disable])";for(var e=document.querySelectorAll(t),n=0;n<e.length;n++){var i=e[n];"password"!==i.type&&m(i)&&i.addEventListener("change",function(){d(this)})}},l=function(){for(var t=document.querySelectorAll("form[data-lux-form-identification]"),e=0;e<t.length;e++)t[e].addEventListener("submit",function(t){t.preventDefault(),x(t.target)})},u=function(){for(var t=document.querySelectorAll("[data-lux-email4link-title]"),e=0;e<t.length;e++){var n=t[e];n.addEventListener("click",function(t){f(this,t)})}},c=function(){if(A())for(var t,e=document.querySelectorAll(v()),n=0;n<e.length;n++)e[n].hasAttribute("data-lux-email4link-title")||(t=e[n].getAttribute("href"),e[n].addEventListener("click",function(){I({"tx_lux_fe[dispatchAction]":"downloadRequest","tx_lux_fe[idCookie]":H(),"tx_lux_fe[arguments][href]":this.getAttribute("href")},S(),null,null)}))},f=function(t,e){e.preventDefault();var i=t.getAttribute("data-lux-email4link-title")||"",a=t.getAttribute("data-lux-email4link-text")||"",r=t.getAttribute("href"),o=document.querySelectorAll('[data-lux-container="email4link"]');if(o.length>0){var l=o[0].cloneNode(!0),u=l.innerHTML;u=u.replace("###TITLE###",i),u=u.replace("###TEXT###",a),u=u.replace("###HREF###",U(r)),n.lightboxInstance=basicLightbox.create(u),n.lightboxInstance.element().querySelector('[data-lux-email4link="form"]').addEventListener("submit",function(e){s(this,e,t)}),n.lightboxInstance.show()}},s=function(t,e,i){e.preventDefault();var a=i.getAttribute("href"),r=i.getAttribute("data-lux-email4link-sendemail")||"false",o=n.lightboxInstance.element().querySelector('[data-lux-email4link="email"]').value;z(o)?(O(),I({"tx_lux_fe[dispatchAction]":"email4LinkRequest","tx_lux_fe[idCookie]":H(),"tx_lux_fe[arguments][email]":o,"tx_lux_fe[arguments][sendEmail]":"true"===r,"tx_lux_fe[arguments][href]":a},S(),"email4LinkLightboxSubmitCallback",{sendEmail:"true"===r,href:a})):R(n.lightboxInstance.element().querySelector('[data-lux-email4link="errorEmailAddress"]'))};this.email4LinkLightboxSubmitCallback=function(t,e){E(),t.error===!0?R(n.lightboxInstance.element().querySelector('[data-lux-email4link="errorEmailAddress"]')):e.sendEmail===!0?(N(n.lightboxInstance.element().querySelector('[data-lux-email4link="form"]')),R(n.lightboxInstance.element().querySelector('[data-lux-email4link="successMessageSendEmail"]')),setTimeout(function(){n.lightboxInstance.close()},2e3)):setTimeout(function(){n.lightboxInstance.close(),window.location=e.href},500)};var d=function(t){var e=h(t,b()),n=t.value;I({"tx_lux_fe[dispatchAction]":"fieldListeningRequest","tx_lux_fe[idCookie]":H(),"tx_lux_fe[arguments][key]":e,"tx_lux_fe[arguments][value]":n},S(),null,null)},x=function(t){for(var e={},n=0;n<t.elements.length;n++){var i=t.elements[n],a=h(i,k());""!==a&&(e[a]=i.value)}I({"tx_lux_fe[dispatchAction]":"formListeningRequest","tx_lux_fe[idCookie]":H(),"tx_lux_fe[arguments][values]":JSON.stringify(e)},S(),null,null)},g=function(){if("1"===navigator.doNotTrack){for(var t=document.querySelectorAll('[data-lux-container-optout="text"]'),e=0;e<t.length;e++)N(t[e]);for(var n=document.querySelectorAll('[data-lux-container-optout="textDoNotTrack"]'),i=0;i<n.length;i++)R(n[i])}},m=function(t){return""!==h(t,b())},h=function(t,e){var n="",i=t.name;for(var a in e)if(e.hasOwnProperty(a))for(var r=0;r<e[a].length;r++)p(i,e[a][r])&&(n=a);return n},v=function(){var t=C().getAttribute("data-lux-downloadtracking-extensions").toLowerCase().split(",");return'a[href$="'+t.join('"],a[href$="')+'"]'},p=function(t,e){if(e.indexOf("*")!==-1){e=e.replace("*","");var n=t.indexOf(e)!==-1}else n=t===e;return n},b=function(){var t={};try{t=JSON.parse(window.luxFieldMappingConfiguration)}catch(e){console.log("Lux: No fieldmapping configuration given.")}return t},k=function(){var t={};try{t=JSON.parse(window.luxFormFieldMappingConfiguration)}catch(e){console.log("Lux: No formfieldmapping configuration given.")}return t},_=function(){var t=!1,e=C();if(null!==e&&e.hasAttribute("data-lux-pagetracking")){var n=e.getAttribute("data-lux-pagetracking");t="1"===n}return t},A=function(){var t=!1,e=C();if(null!==e&&e.hasAttribute("data-lux-downloadtracking")){var n=e.getAttribute("data-lux-downloadtracking");t="1"===n}return t},w=function(){var t=0,e=C();if(null!==e&&e.hasAttribute("data-lux-pageuid")){var n=e.getAttribute("data-lux-pageuid");t=parseInt(n)}return t},y=function(){return encodeURIComponent(document.referrer)},L=function(){""===e&&(e=M(32),P(t,e))},S=function(){var t=C();return null!==t?t.getAttribute("data-lux-requesturi"):""},I=function(t,e,i,a){if(a=a||{},""!==e){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===this.readyState&&200===this.status&&null!==i&&n[i](JSON.parse(this.responseText),a)},r.open("POST",q(e,t),!0),r.send()}else console.log("No ajax URI given!")},q=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t+=t.indexOf("?")!==-1?"&":"?",t+=n+"="+e[n]);return t},T=function(){return j()===!1&&"1"!==navigator.doNotTrack&&null!==C()&&"1"===C().getAttribute("data-lux-enable")},C=function(){return document.getElementById("lux_container")},O=function(){document.body.className+=" lux_waiting"},E=function(){document.body.classList.remove("lux_waiting")},N=function(t){t.style.display="none"},R=function(t){t.style.display="block"},M=function(t){for(var e="",n="abcdefghijklmnopqrstuvwxyz0123456789",i=0;i<t;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e},z=function(t){var e=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)},U=function(t){var e=t.replace(/^.*[\\\/]/,""),n=["pdf","txt","doc","docx","xls","xlsx","ppt","pptx","jpg","png","zip"];return D(W(e).toLowerCase(),n)&&(t=e),t},D=function(t,e){for(var n=e.length,i=0;i<n;i++)if(e[i]===t)return!0;return!1},W=function(t){return t.indexOf(".")!==-1?t.split(".").pop():""},j=function(){return"true"===$("luxTrackingOptOut")},F=function(){P("luxTrackingOptOut",!0)},J=function(){P("luxTrackingOptOut",!1)},H=function(){return $(t)},P=function(t,e){var n=new Date,i=n.getTime();i+=31536e7,n.setTime(i),document.cookie=t+"="+e+"; expires="+n.toUTCString()+"; path=/"},$=function(t){for(var e=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var a=n[i];" "===a.charAt(0);)a=a.substring(1);if(0===a.indexOf(e))return a.substring(e.length,a.length)}return""}}var Lux=new window.LuxMain;Lux.initialize();